"example_input_question","example_output_query"
"Wie viele Tore und Assists oder hat Thomas Müller in der Saison 23/24 geschossen?", "SELECT sum(gls) as goals, sum(ast) as assists, sum(g_plus_a) as goals_assists FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE playername = 'Thomas Müller' and season like '%24%' group by season;"
"Welche Positionen spielt Spieler Thomas Müller?", "SELECT season, playerposition, COUNT(*) AS frequency FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE playername = 'Thomas Müller' AND season like '%24%' GROUP BY playerposition, season;"
"Wie viele Pässe hat Marvin Mehlem am ersten Spieltag gespielt", "select sum(p) FROM "AwsDataCatalog"."d98-ai-agent"."impect_data_cleaned" where playername = 'Marvin Mehlem' and matchdayindex = 0 and season like '%24%' group by 'season';"
"Welche Distanz ist Marvin Mehlem gelaufen in dieser Saison?", "SELECT sum("running_distance") FROM "AwsDataCatalog"."d98-ai-agent"."impect_data_cleaned" WHERE playername = 'Marvin Mehlem' and season like '%24%' GROUP BY season;"
"Wie viele Tore hat der SV Darmstadt in der Saison 23/24 geschossen?", "SELECT sum(gls) FROM "AwsDataCatalog"."d98-ai-agent"."impect_data_cleaned" WHERE lower(squadname) like '%darmstadt%' AND season like '%24%' group by season;"
"Wie gut hat Thomas Müller offensiv gespielt in der der Saison 23/24", "WITH calculated_scores AS (SELECT playername, (90.0 / minutesplayed) * CAST(xt_offensiv AS double) AS weighted_score, competitionname FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE minutesplayed > 0 AND season LIKE '%24%'), average_scores AS (SELECT cs.playername, SUM(cs.weighted_score) / COUNT(cs.weighted_score) AS average_score, cs.competitionname FROM calculated_scores cs GROUP BY cs.playername, cs.competitionname), league_average AS (SELECT competitionname, AVG(average_score) AS league_average_score FROM average_scores GROUP BY competitionname), ranked_scores AS (SELECT playername, average_score, competitionname, RANK() OVER (PARTITION BY competitionname ORDER BY average_score DESC) AS player_rank FROM average_scores) SELECT rs.playername, rs.average_score, rs.player_rank, la.league_average_score FROM ranked_scores rs JOIN league_average la ON rs.competitionname = la.competitionname WHERE rs.playername = 'Thomas Müller';"
"Wie gut hat Thomas Müller offensiv gespielt im Vergleich zu Manuel Neuer in der der Saison 23/24", "WITH calculated_scores AS (SELECT playername, (90.0 / minutesplayed) * xt_offensiv AS weighted_score FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE minutesplayed > 0 AND playername IN ('Thomas Müller', 'Manuel Neuer') AND season LIKE '%24%') SELECT playername, SUM(weighted_score) / COUNT(weighted_score) AS average_score FROM calculated_scores GROUP BY playername;"
"Wie gut hat Harry Kane defensiv gespielt im Vergleich zu Dayot Upamecano in der der Saison 23/24", "WITH calculated_scores AS (SELECT playername, competitionname, (90.0 / minutesplayed) * CAST(NULLIF(xt_defensiv, '') AS double) AS weighted_score FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE minutesplayed > 0 AND season LIKE '%24%'), average_scores AS (SELECT cs.playername, cs.competitionname, SUM(cs.weighted_score) / COUNT(cs.weighted_score) AS average_score FROM calculated_scores cs WHERE cs.weighted_score IS NOT NULL GROUP BY cs.playername, cs.competitionname), harry_kane_league AS (SELECT DISTINCT competitionname FROM average_scores WHERE playername = 'Harry Kane'), league_average_scores AS (SELECT ascores.playername, ascores.average_score, ascores.competitionname FROM average_scores ascores JOIN harry_kane_league hkl ON ascores.competitionname = hkl.competitionname), league_average AS (SELECT AVG(average_score) AS league_average_score FROM league_average_scores), ranked_scores AS (SELECT playername, average_score, RANK() OVER (PARTITION BY competitionname ORDER BY average_score DESC) AS player_rank FROM league_average_scores) SELECT rs.playername, rs.average_score, rs.player_rank, la.league_average_score FROM ranked_scores rs CROSS JOIN league_average la WHERE rs.playername IN ('Harry Kane', 'Dayot Upamecano');"
"Wie gut waren Thomas Müllers Pässe in der Saison 23/24", "WITH filtered_data AS (SELECT playername, minutesplayed, competitionname, CASE WHEN REGEXP_LIKE(xt_passspiel, '^[0-9]*\.?[0-9]+$') THEN CAST(xt_passspiel AS double) ELSE NULL END AS xt_passspiel FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE minutesplayed > 0 AND season LIKE '%24%'), calculated_scores AS (SELECT playername, (90.0 / minutesplayed) * xt_passspiel AS weighted_score, competitionname FROM filtered_data WHERE xt_passspiel IS NOT NULL), average_scores AS (SELECT cs.playername, SUM(cs.weighted_score) / COUNT(cs.weighted_score) AS average_score, cs.competitionname FROM calculated_scores cs GROUP BY cs.playername, cs.competitionname), league_average AS (SELECT competitionname, AVG(average_score) AS league_average_score FROM average_scores GROUP BY competitionname), ranked_scores AS (SELECT playername, average_score, competitionname, RANK() OVER (PARTITION BY competitionname ORDER BY average_score DESC) AS player_rank FROM average_scores) SELECT rs.playername, rs.average_score, rs.player_rank, la.league_average_score FROM ranked_scores rs JOIN league_average la ON rs.competitionname = la.competitionname WHERE rs.playername = 'Thomas Müller';"
"Wie viele Elfmeter hat Thomas Müller in der Saison 23/24" geschossen?", "SELECT SUM(pkatt) FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE playername = 'Harry Kane' AND season LIKE '%24%';"
"Wie viele Elfmeter hat Thomas Müller in der Saison 23/24" verfehlt?", "SELECT SUM(pkatt) - SUM(pk) AS missed_penalties FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE playername = 'Harry Kane' AND season LIKE '%24%';"
"Wie viele Elfmeter hat Thomas Müller in der Saison 23/24" getroffen?", "SELECT SUM(pk) FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE playername = 'Harry Kane' AND season LIKE '%24%';"
"In welcher Altersgruppe liegt Thomas Müller?", "SELECT playeragegroup FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE playername = 'Thomas Müller' ORDER BY CASE WHEN playeragegroup = 'Youth' THEN 4 WHEN playeragegroup = 'Pre-Prime' THEN 3 WHEN playeragegroup = 'Prime' THEN 2 WHEN playeragegroup = 'Post-Prime' THEN 1 END DESC LIMIT 1;"
"Wie alt ist Thomas Müller?", "SELECT MAX(playerage) FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE playername = 'Thomas Müller';"
"Wie gut sind Thomas Müllers Flanken?", "SELECT AVG(crss_percentage) * 100 AS average_crss_percentage FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE playername = 'Thomas Müller' AND season LIKE '%24%' AND (crs IS NOT NULL AND crs > 0);"
"Wer spielt die sichersten Pässe in der gesamten 1. Bundesliga?", "SELECT playername, AVG(p_percentage) * 100 AS average_pass_completion_rate FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE competitionname = '1. Bundesliga' GROUP BY playername ORDER BY average_pass_completion_rate DESC LIMIT 5;"
"In welcher Liga spielt Harry Kane?", "SELECT DISTINCT competitionname, countryname FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE playername = 'Harry Kane' AND season LIKE '%24%';"
"Wie viele Spielminuten hatte Harry Kane in der letzten Saison?", "SELECT SUM(minutesplayed) FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE playername = 'Harry Kane' AND season LIKE '%24%';"
"Wie viele Tore hat Harry Kane pro Spiel geschossen?", "SELECT DISTINCT competitionname, countryname FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE playername = 'Harry Kane' AND season LIKE '%24%';"
"Welcher Fuß ist Harry Kanes starker Fuß?", "SELECT DISTINCT playerleg FROM ""AwsDataCatalog"".""d98-ai-agent"".""impect_data_cleaned"" WHERE playername = 'Harry Kane';"
